function [hks] = myHKS(X,v,time)

% v:= #autofunzioni in base

[X.S, ~, X.M] = calc_LB_FEM(X);
[X.phi, X.lambda] = eigs(X.S,X.M, v, 'sm');
[X.lambda, idx] = sort(diag(X.lambda));
X.phi = X.phi(:,idx);


%% costruisco l'heat kernel

hks = zeros(X.n,time); %sulla colonna i_esima avrò la digonale dell'Heat Kernel a tempo 'i'

colors = hot(200);
colors = colors(end:-1:1,:);

Xt = X.phi';




%%%%%%%%%%%%%% CALCOLO HKS PER TUTTI I PUNTI, PER TUTTI I TEMPI %%%%%%%%%%%
for t=1:time % per ogni istante di tempo
    for p=1:X.n % per ogni punto della shape
        hX.phi(p,:) .* spdiag(exp(X.lambda*-t)) * Xt(:,p)
    
    
    end
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%% ORA VISUALIZZO HKS SULLA MESH %%%%%%%%%%%%%%%%%%%%%
figure, colormap(colors)




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




end